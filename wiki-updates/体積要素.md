SPH法では、流体をSPH粒子へと離散化して取り扱います。そのためには、各粒子の体積
$dV$
が必要です。
体積はSPH粒子が持つ物理量
$Z$
とそれに対応する連続的な場
$y$
から、

$dV = \frac{Z}{y}$

と得られます。

## $Z = m$, $y = \rho$ の場合
密度を基本量として体積要素を計算するのはSPH法において標準的な方法で、この方法は**標準SPH法** (Standard SPH; SSPH)とも呼ばれます。
このとき、密度は質量のカーネル和として次のように表せます:

$$
\begin{align*}
\rho_i &= \sum_j dV_j \rho_j W(r_{ij}, h_i)\\
 &= \sum_j \frac{m_j}{\rho_j} \rho_j W(r_{ij}, h_i) \\
 &= \sum_j m_j W(r_{ij}, h_i) 
\end{align*}
$$

標準SPH法では上の式で求めた密度を使って他の物理量を求めます。
例えば圧力は状態方程式から求められます。1D_SPHでは理想気体状態方程式を採用しており、

$$
P = (\gamma - 1)\rho u
$$

です。ただし、
$\gamma$
は比熱比、
$u$
は単位質量あたり内部エネルギーです。

## $Z = mu$, $y = P/(\gamma - 1)$ の場合
標準SPH法ではカーネル和として得られる密度を元に他の物理量を計算します。カーネル和をとると場がなまされてしまうため、接触不連続面のように密度が不連続に変化する箇所を精度良く取り扱うことができません (Agertz et al. 2007)。この問題を解消するため、Saitoh & Makino (2013) は圧力を基本量としてSPH法を定式化する手法を提案しました。この方法は density-independent SPH (DISPH)と呼ばれます。基本量である圧力は

$$
P_i= (\gamma - 1)\sum_j m_j u_j W(r_{ij}, h)
$$

と求められて、この圧力を元に他の物理量を計算します。
接触不連続面の前後では圧力一定なので、DISPHでは接触不連続面前後の物理量を精度よく扱うことができます。

## 参考文献
- Agertz, O. et al., “Fundamental differences between SPH and grid methods”, <i>Monthly Notices of the Royal Astronomical Society</i>, vol. 380, no. 3, pp. 963–978, 2007. doi:10.1111/j.1365-2966.2007.12183.x.
- Saitoh, T. R. and Makino, J., “A Density-independent Formulation of Smoothed Particle Hydrodynamics”, <i>The Astrophysical Journal</i>, vol. 768, no. 1, 2013. doi:10.1088/0004-637X/768/1/44.

